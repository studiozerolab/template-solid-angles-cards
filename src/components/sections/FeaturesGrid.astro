---
import AngleEdge from "../ui/AngleEdge.astro";

const {
  id,
  title,
  items = [],
  bg = "surface",       // surface | alt | primary-tint | accent-tint
  prevBg = "surface",
  nextBg = "surface",
  angleTop = false,
  angleBottom = true,
  dirTop ="left",   // left | right
  dirBottom = "right", // left | right
} = Astro.props;

// Central map: token -> class name (matches your CSS) and a SOLID hex for SVG fills
const BG = {
  surface:       { class: "section--surface",       fill: "#FFFFFF" },       
  alt:           { class: "section--alt",           fill: "#F8FAFC" },
  mid:           { class: "section--mid",           fill: "#F1F5F9" },
  strong:        { class: "section--strong",        fill: "#E2E8F0" },
  "primary-tint":{ class: "section--primary-tint",       fill: "#E7F0FF" },       
  "accent-tint": { class: "section--accent-tint",        fill: "#FFF4E5" },       
};

const bgClass    = BG[bg]?.class       ?? BG.surface.class;
const fillTop    = BG[prevBg]?.fill    ?? BG.surface.fill;   // top seam fills previous section color
const fillBottom = BG[nextBg]?.fill    ?? BG.surface.fill;   // bottom seam fills next section color

// const bgClass =
//   bg === "alt" ? "section-alt" :
//   bg === "primary-tint" ? "section-primary-tint" :
//   bg === "accent-tint" ? "section-accent-tint" :
//   "section-surface";

// const nextColor =
//   nextBg === "alt" ? "#F8FAFC" :
//   nextBg === "primary-tint" ? "color-mix(in srgb, #2563EB 6%, #ffffff)" :
//   nextBg === "accent-tint" ? "color-mix(in srgb, #F59E0B 6%, #ffffff)" :
//   "#FFFFFF";
---

<section id={id} class={`section ${bgClass}`}>
  {angleTop && <AngleEdge position="top" direction={dirTop} fill={fillTop} height={120} />}

  <div class="card-shell px-6 py-16">
    <h2 class="text-2xl md:text-3xl font-bold mb-8">{title}</h2>
    <div class="card-grid grid gap-6 sm:gap-8 md:grid-cols-2 lg:grid-cols-3 items-stretch">
      {items.map((it) => (
        <article class="card-vitae overflow-hidden rounded-lg border border-line bg-white shadow-sm flex flex-col h-full">
          {it.image && (
            <div class="relative w-full aspect-[16/9] rounded-t-lg overflow-hidden card-image">
              <img src={it.image} alt="" loading="lazy" class="absolute inset-0 block h-full w-full object-cover"/>
            </div>
          )}
            
          <div class="body flex-1 p-5 flex flex-col">
            <h3>{it.title}</h3>
            {it.body && <p>{it.body}</p>}
            <a href={it.href ?? "#"} class="cta mt-auto mx-auto inline-flex items-center justify-center gap-2 rounded-md border border-line px-5 py-2 text-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-primary/30 w-fit">Learn more</a>
          </div>
        </article>
      ))}
    </div>
  </div>

  {angleBottom && <AngleEdge position="bottom" direction={dirBottom} fill={fillBottom} height={120} />}
</section>
